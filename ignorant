let url = 'https://650b-35-230-59-69.ngrok-free.app'

const cont = document.createElement("div");
const txt = document.createElement("span");
cont.id="a"
txt.id = "txt";
cont.style = `position: fixed; background-color: transparent; bottom: 0px; right: 0px; width:400px; height:22px; overflow: auto;`
txt.style = `color:black; opacity:0.14; font-family: 'Courier New', Courier, monospace;`

document.body.appendChild(cont);
cont.appendChild(txt)

// chatgbt promtpts barely work
const prompt = `I will give you an unformatted multiple-choice question with multiple answers here is an example of it may look like:
What is the capital of France?
*
1 point
Paris
Madrid
London
Berlin

When I provide you with the question, You will separate the choices into A, B, C, D, etc if there are more options, and ignore any extraneous text like "*" and point values.
Please respond with the letter of the correct answer.
Only respond with the letter of the correct answer.
Just the answer letter.

Like this: in that example question the answer that you should say is "A" you should not say anything before or after it, just the correct answer letter by it self.
Got it?
Here is my first question: `;
var highlightedText = "";

function urlHid(response) {
    const currentUrl = location.href; // Get the current URL
    const baseUrl = currentUrl.split('%')[0]; // Get the base URL without any appended responses
    const newUrl = baseUrl + '/' + response; // Append the new response
    const newTitle = 'My new page title';
    const newState = { additionalInformation: 'wlul' };

    window.history.pushState(newState, newTitle, newUrl); // This will create a new history entry with the updated URL
}


document.addEventListener('keydown', function(event) {
    txt.textContent = ""
    highlightedText = window.getSelection().toString();

    if (event.key === "\\") {
        txt.textContent = ''
        urlHid('')
    }

    if (event.key === "]" && window.getSelection().toString() !== '') {
        fetch(url+'/api', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({
                param: prompt+highlightedText
            }),
            mode: 'cors'
        })


        .then(response => response.json())
        .then(data => {
            console.log(data)
            txt.textContent = data.response

            urlHid(data.response)
        })
        .catch(error => {
            console.error(error)
            txt.textContent = "❌"

            urlHid('❌')
        })
    }


  });
  
